services:
    {{ project_name }}:
        build: .
        ports:
            - "{{ port }}:{{ port }}"
        environment:
            - ENVIRONMENT=production
            - PORT={{ port }}
            - HOST=0.0.0.0
        env_file:
            - .env.production
        volumes:
            - .:/app
        command: gunicorn src.app:server --bind 0.0.0.0:{{ port }}
        restart: unless-stopped
        healthcheck:
            test: ["CMD", "curl", "-f", "http://localhost:{{ port }}"]
            interval: 30s
            timeout: 10s
            retries: 3
            start_period: 40s